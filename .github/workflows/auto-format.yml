name: "Auto-format Python code"

on:
  pull_request:
    types: [opened, synchronize, reopened]
  workflow_dispatch: 
  
jobs:
  format:
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v4
        with:
          # grant push rights to the GITHUB_TOKEN
          persist-credentials: true

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install formatter & linter
        run: |
          pip install black==25.1.0 ruff==0.12.5

      - name: Run Black & Ruff
        run: |
          black .
          ruff --fix .

      - name: Commit & push formatted changes
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: "chore(auto-format): apply Black & Ruff fixes"
          file_pattern: "**/*.py"
